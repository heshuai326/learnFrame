## GraphQL简介
GraphQL是一种新的API标准，可提供更高效，更强大，更灵活的REST替代方案
> API定义了客户端如何从服务器加载数据

GraphQL支持生命性数据提取，客户端可以从API中准确指定所需的数据。GrapHQL服务器只显示单个端点，就可以精确响应客户端要求的数据，二不是返回固定数据格式的多个端点
### API查询语言
1、API负责为存储的数据提供合适应用程序需求的接口<br>
2、GraphQL经常与数据库技术混淆。他是API查询语言而不是数据库，他是数据库不可知的，并且可以有效地用于API的任何上下文中
### 一种更有效的REST替代方案
1、增加的移动使用量需要加载有效的数据：最大限度的减少了需要通过网络传输的数据量<br>
2、各种不同前端框架和平台：难以维护<br>
3、快速开发

## GraphQL是更好的REST
### 数据不多不少
REST请求返回的数据结构是固定的，GraphQL能够与为客户端提供确切的数据需求
### 下载多余的数据
客户端下载的数据超过了应用程序中国实际需要的数据
### 欠缺和N+1问题
数据列表不满足所需的数据，随后需要为每个元素添加一个额外的请求
### 前端的快速产品迭代
### 后端进行前瞻性的分析

### 核心概念
#### Schema定义语言（SDL）
GraphQL有自己的类型新系统，用于定义Schema。编写Schem的语法称为SDL（模式定义语言）
```
type Person{
  name: String!
  age: Int!
  posts: [Post!]!
}

type Post{
  title: String!
  author: Person!
}
```
### 使用查询获取数据
完全灵活，让客户决定需要哪些数据
#### 查询Query
允许自然查询嵌套信息
```
query{
  persons(last:1){
    name
    posts{
      title
    }
  }
}
```
#### 修改数据(Mutations)
- 创建新数据
- 更新数据
- 删除数据
```
mutation{
  createPerson(name:'heshuai',age:22) {
    id,
    name,
    age
  }
}

mutation{
    updatePersion(id:'111111') {
        id,
        name,
        age
    }
}
```
#### 订阅实时更新
应用程序另有一个重要的要求是与服务器建立试试连接，对此GraphQL提供了订阅的概念
当客户端订阅某个事件时，它将启动并保持与服务器的稳定连接。每当该特定事件发生时，服务器就将相应的数据推送到客户端。订阅表示发送到客户端的数据流。
```
subscription{
  newPerson{
    name,
    age
  }
}
```
#### 定义schema
schema是最重要的概念之一。它指定API的功能并定义客户端如何请求数据。他通常被视为服务器和客户端之间的约定

## Architecture
如果你想用GraphQL，必须自己构建GrapQL服务器。
### 用例
1、具有连接数据库的GraphQL服务器
2、GraphQL服务器，它是需要第三方或遗留系统之间的中间层，并通过单个GraphQLAPI集成他们
3、可以通过相同的GraphQLAPI进行访问
### 具有连接数据库的GraphQL服务器
1、当查询到达GraphQL服务器时，服务器将读取查询的邮箱内容并从数据库中获取所需的信息，这称为解析查询。
2、GraphQL与传输城无关。这意味着他可以与任何可用的网络协议一起是哟经。因此，有可能基于TCP，Websockets等的GrapQL服务器
3、GraphQL不关心数据库和存储数据的格式，关系型数据库和和非关系型数据库都㐓用
### 集成现有系统的GraphQL层
运行客户端应用程序的前端框架和平台的异构环境使得构建和维护一个满足所有徐亚欧的API变得困难。使用GraphQL，每个客户端都可以精确访问所需数据。<br>
在这种情况下，GraphQL可用于同意这些现有西永，并隐藏其背后的复杂性。这样就可以开发新的客户端应用程序，只需要与GraphQL服务器通信即可获取所需的数据。然后，GraphQL服务器负责凶现有系统中获取数据并以GraphQL响应格式响应。<br>
持续部署已成为许多公司的标准，快速迭代和频繁的产品更新更是必不可少。使用REST API，通常需要修改服务器公开数据的方式，以满足客户端的特定要求和设计更改。这阻碍了快速开发实践和产品迭代。
### 解析器功能
当服务器收到查询时，他讲调用查询啊有效负载中指定的字段的素偶有函数。因此，他解析了查询，并能够为每个字段检索正确的数据。一旦所有解析器返回，服务器将以查询描述的格式打包数据并将其发送回客户端。
### GraphQL客户端库
GraphQL完全消除了REST API遇到的许多不便和缺点，例如过多过少。复杂性被推向服务器端，，强大的机器可以处理繁重的计算工资。客户端不必知道他所获得的数据实际来自何处。

query{
  post(id) {
    id
    user[]
  }
}